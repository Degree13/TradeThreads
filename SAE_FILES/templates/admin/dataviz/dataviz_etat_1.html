{% extends 'admin/layout_admin.html' %}


{% block javascripts %}
{#    attention il faut importer la bibliotheque chart.js avant de définir l'objet chart#}
    {{ super() }}
   {# <script src="{{ url_for('static', filename='bootstrap/js/bootstrap.js') }}" ></script>
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> #}
{% endblock %}

{% block javascripts_head %}
{#    attention il faut importer la bibliotheque chart.js avant de définir l'objet chart#}
{#    <script src="{{ url_for('static', filename='chart.js') }}" ></script>#}
      <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.0/chroma.min.js"></script>
{% endblock %}

{% block title %}
    <title>visualisation de données</title>
{% endblock %}

{% block body %}
<br>

<table class="table">
    <thead class="thead-dark">
        <tr>
           <th>Liste des articles</th> <th>(id)</th><th>NB fav</th>
        </tr>
    </thead>
    <tbody>
    {% if datas_show | length >= 1 %}
        {% for ligne in datas_show %}
           <tr>
                  <td>{{ ligne.libelle }}</td>
                  <td>{{ ligne.id_vetement }}</td>
                   <td><span style="color: red">
                       {% if ligne.nbr_articles is not none %}
                           {{ ligne.nbr_articles }}
                       {% else %}
                           pas d'article
                       {% endif %}
                   </span>
                   </td>
           </tr>
        {% endfor %}
    {% else %}
        pas de stock
    {% endif %}
    </tbody>
</table>
<br>
{#    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>#}

<h2>visualisation de données : graph.js</h2>
<h3>Documentation</h3>
<br>
    <a href="https://tobiasahlin.com/blog/chartjs-charts-to-get-you-started/" target="_blank"> tuto partie1 graph.js</a><br>
    <a href="https://tobiasahlin.com/blog/introduction-to-chartjs" target="_blank"> tuto partie2 graph.js</a>&nbsp;
<br>
    <a href="https://www.youtube.com/watch?v=E2hytuQvLlE" target="_blank"> vidéo : flask + graph.js</a>&nbsp;
    <br>

{# https://jinja.palletsprojects.com/en/3.0.x/templates/#html-escaping #}
    <div style="width: 900px; height: 500px; border: #0a53be 1px solid;">
        <canvas id="Chart1" ></canvas>
    </div>
    graphique 1
    <script>
    const colorScale1 = chroma.scale(['#e60073', '#f3c30b', '#008ae6']);
    const colors1 = colorScale1.colors({{ labels | length }});
    const colorScale2 = chroma.scale(['#9400D3', '#FE2E2E']);
    const colors2 = colorScale2.colors({{ labels | length }});
	var ctx1 = document.getElementById("Chart1").getContext("2d");
	var Chart1 = new Chart( ctx1, {
  		type: "bar",
  		data: {
  			labels: {{ labels | safe }},
  			datasets: [
  				{
  				label: "Nombre de favoris par article",
  				data: {{ values | safe }},
  				fill: false,
                backgroundColor: colors2,
  				borderColor: "rgb(75,192,192)",
  				lineTension: 0.1
  				}
  			]
  		},
  		option: {
  			responsive: false
  		}
	});
    </script>

    <div style="width: 900px; height: 500px; border: #0a53be 1px solid;">
        <canvas id="Chart3" ></canvas>
    </div>
    graphique 3
    <script>
    var ctx3 = document.getElementById("Chart3").getContext("2d");
    const colorScale3 = chroma.scale(['#9400D3', '#FE2E2E']);
    const colors3 = colorScale3.colors({{ labels2 | length }});
    var Chart1 = new Chart( ctx3, {
        type: "bar",
        data: {
            labels: {{ labels2 | safe }},
            datasets: [
                {
                label: "Nombre de vues par article",
                data: {{ values2 | safe }},
                fill: false,
                backgroundColor: colors3,
                borderColor: "rgb(75,192,192)",
                lineTension: 0.1
                }
            ]
        },
        option: {
            responsive: false
        }
    });
    </script>


    <h2>demo graphique à secteurs : "camenberd" ,"donut" ( "pie-chart"  "doughtnut")</h2>

    <canvas id="pie-chart" width="800" height="450"></canvas>

    <script>
	var Chart2 = new Chart(document.getElementById("pie-chart"), {
    type: 'pie',
    data: {
      labels: {{ labels | safe }},
      datasets: [{
        label: "Nombre de favoris par article",
         backgroundColor: colors1,
        data: {{ values | safe }},
      }]
    },
    options: {
      title: {
        display: true,
        text: 'Articles : nombre de favoris'
      }
     }
    });
    </script>

    <a href="https://www.youtube.com/watch?v=TcwYXIIM-fs" target="_blank">dataviz, c'est quoi en 1 mn ? (juste la première minute)</a>
    <br>
    <a href="https://www.youtube.com/watch?v=bZDnSUjfMt8" target="_blank">dataviz, c'est quoi ? (juste la première minute)</a>
{% endblock %}
